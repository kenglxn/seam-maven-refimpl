<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<link rel="stylesheet" href="../styles/base/base.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../styles/page-layout/page-layout.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../styles/site/site.css" type="text/css" media="screen" />
<title>Seam Maven reference Implentation - Eclipse</title>
</head>
<body>

<div id="sizer">
<div id="expander">
<div id="page-wrapper">
<div id="header">
<div class="header">
  <h1>Using Maven, Eclipse and JBoss Tools</h1>
</div>
</div> 
<div id="page">
<p>This tutorial explains how to use the Eclipse IDE and JBoss Tools with a Mavenized Seam project.</p>

<h2>Shortcuts</h2>
<p>The shortcuts are listed here so we don't have to type the tedious file 
  paths over and over again in this document.</p>
<ul>
  <li><code>${JBOSS_HOME}</code> - refers to Jboss installation folder, e.g. C:\servers\jboss-4.2.3.GA</li>
  <li><code>${JBOSS_CONFIG}</code> - refers to the configuration directory e.g. C:\servers\jboss-4.2.3.GA\default
  <li><code>${JBOSS_DEPLOY}</code> - refers to the JBoss deploy folder, e.g. C:\servers\jboss-4.2.3.GA\default\deploy</li>
  <li><code>${PROJECT}</code> - the project root folder, i.e. seam-maven-refimpl</li>
  <li><code>${SEAM_REFIMPL}</code> - the folder where the reference project, i.e. seam-refimpl, is installed on your computer</li>
  <li><code>${SEAM_TUTORIAL}</code> - the folder where the tutorial project, i.e. seam-tutorial, is installed on your computer</li>
</ul>

<h2>Download and install software:</h2>
<ul class="vspace">
  <li><a href="http://java.sun.com/javase/downloads/index.jsp">jdk-1.5 or jdk-1.6</a></li>
  <li>
		<a href="http://www.eclipse.org/ganymede/">
		Eclipse Ganymede 3.4 (with WTP installed)</a>
	</li>
  <li>
		<a href="http://maven.apache.org/download.html">Maven 2.0.9</a> or later.<br/>
    <strong>Note:</strong> Do not use Maven 2.1.0, it has a serious bug regarding the use of 
		<code>profiles.xml</code>, see the <code>${PROJECT}/doc/maven-2.1.0-bug</code> folder for an 
		explanation
  </li>
  <li><a href="http://m2eclipse.sonatype.org/">Maven Eclipse plugin</a> (0.9.8 or later)</li>
  <li>
		<a href="http://subclipse.tigris.org/">
		SubClipse-1.6.x, Team Provider plug-in providing support for Subversion within the Eclipse IDE
		</a>.
	</li>
	<li><a href="http://www.seamframework.org/Download">JBoss Seam 2.2.0.GA</a> source code (for JBoss Tools)</li>
  <li><a href="http://www.jboss.org/tools">JBoss Tools 3</a></li>
  <li><a href="http://www.jboss.org/jbossas/">Jboss 4.2.3.GA Application Server</a> or later</li>
  <li><a href="http://testng.org/doc/eclipse.html">TestNG</a></li>
</ul>

<h2 id="configure-the-workspace">Configure the Workspace</h2>
<ol class="vspace">
  <li>
		Create an empty workspace folder, e.g. 
		<code style="white-space:nowrap">C:/dev/ide/workspaces/eclipse-3.4</code><br/>
    <font color="red"><strong>Note:</strong> Do not add Maven projects under your workspace 
		folder.</font> There are some issues regarding use of the m2eclipse plugin when projects are 
		placed under the workspace folder, e.g. <code style="white-space:nowrap">
		C:/dev/ide/workspaces/eclipse-3.4/myproject</code>: You will not be able to run Maven Eclipse 
		goals from a command shell if your project is placed under the workspace folder; the 
		<code>mvn eclipse:eclipse, mvn eclipse:clean and mvn eclipse:m2eclipse</code> goals will fail to 
		execute. The issues are reported here: <a href="http://jira.codehaus.org/browse/MECLIPSE-571">
		http://jira.codehaus.org/browse/MECLIPSE-571</a>, and here:	
		<a href="http://jira.codehaus.org/browse/MNG-2057">http://jira.codehaus.org/browse/MNG-2057</a>.
		So, be kind to yourself and create a project folder that is not on the same file path as the 
		workspace folder, e.g. <code style="white-space:nowrap">C:/dev/projects</code>
	</li>
  <li>
		Start Eclipse and select the newly created workspace folder.
    <img src="img/eclipse-workspace-launcher.png" style="width:560px; display:block;" />
  </li>
	<!--
	<li>
	  <strong>Import code styles - To be done!</strong>
	</li>
	-->
</ol>

<h3>Make sure that Eclipse is running on a JDK and not a JRE.</h3>
<ol class="vspace">
  <li>
		Select <code><strong>Window>Preferences</strong></code> and browse to the 
		<code><strong>Java>Installed JREs</strong></code> section. 
		<img src="img/eclipse-installed-jres.png" style="width:640px; display:block;" />
		<img src="img/eclipse-compiler.png" style="width:640px; display:block;" />
	</li>
</ol>

<h3>Configure The Maven Eclipse Plugin</h3>
<ol class="vspace">
	<li>Install the <a href="http://m2eclipse.codehaus.org/">Maven Eclipse plugin</a>.</li>
  <li>
	  Configure the Maven Eclipse plugin.
		<img src="img/eclipse-maven-plugin.png" style="width:640px; display:block;" />
	</li>
	<li>
		Configure Eclipse to use an <strong>external</strong> Maven installation.<br/>
		According to this blogs:
		<a href="http://www-02.imixs.com:8081/roller/ralphsjavablog/entry/eclipse_maven_install_from_runas">
		ECLIPSE: MAVEN INSTALL FROM RUN AS MENU FAILS</a> and 
		<a href="http://www.innovationontherun.com/common-issues-and-workarounds-while-building-ear-files-in-eclipse/"
			style="white-space:nowrap">
		Common Issues and Workarounds While Building EAR files in Eclipse</a>, 
		there are some issues when running embedded Maven from Eclipse, so we need to configure Eclipse to 
		use an external Maven installation. In Preferences, navigate to 
		<code><strong>Maven>Installations</strong></code> and edit details as outlined in the image below.
		<img src="img/eclipse-maven-installations.png" style="width:640px; display:block;" />
	</li>
</ol>

<h3>Install the JBoss Application Server and JBoss Tools</h3>
<ol class="vspace">	
	<li>
	  Install the <a href="http://www.jboss.org/jbossas/">Jboss Application Server</a>
	</li>
	<li>
		Install <a href="http://www.jboss.org/tools">JBoss Tools 3</a>
	</li>
	<li>
		The <a href="http://seamframework.org/Documentation">
		JBoss Seam documentation</a> explains these steps in detail.
	</li>
</ol>

<h3>Create a WTP Server Reference</h3>
<p>After the Server and the tools are installed you need to define a WTP server reference. The 
screenshots below outlines the steps needed to configure a WTP server reference for JBoss 4.2.3.</p>
<ol class="vspace">	
	<li>
		In Preferences, navigate to <strong>Server>Runtime Environments</strong>. Click 
		<strong>Add...</strong>. Browse to the folder named <strong>JBoss Community</strong> 
		and select <strong>JBoss 4.2 Runtime</strong>.
		<img src="img/eclipse-server-runtime-01.png" style="width:750px; display:block;" />
	</li>
	<li>
		Click <strong>Next</strong>, name the server runtime, e.g. JBoss 4.2.3-jdk6 Runtime, and point the 
		<strong>Home Directory</strong> to the folder where you installed the	server. Select the 
		<strong>default</strong> configuration. 
		<img src="img/eclipse-server-runtime-02.png" style="width:400px; display:block;" />
	</li>
	<li>
		Click <strong>Next</strong>, name the server, e.g. JBoss 4.2.3-jdk6 Server, and click 
		<strong>Finish</strong>.
		<img src="img/eclipse-server-runtime-03.png" style="width:400px; display:block;" />
	</li>
	<li>
		Exit Preferences and switch to the JBoss perspective.
		<img src="img/eclipse-jboss-perspective.png" style="width:300px; display:block;" />
	</li>
	<li>
		Doubleclick on the newly created server, JBoss 4.2.3-jdk6 Server, to open the Server Overview 
		editor.
		<img src="img/eclipse-jboss-server-view.png" style="width:240px; display:block;" />
	</li>
	<li>
		Verify that the <code><strong>Use the JBoss deploy folder</strong></code> radio button is checked.
		<img src="img/eclipse-jboss-server-overview.png" style="width:750px; display:block;" />
	</li>
	<li>
	  Start the server to check that everyting is configured correctly.
    <img src="img/eclipse-server-view-start-server-01.png" style="width:250px; display:block;" />
	</li>
	<li>
		The console output should look something like the screeshot below.
		<img src="img/eclipse-jboss-server-view-started.png" style="width:750px; display:block;" />
	</li>
	<li>
	  Stop the server.
  </li>
</ol>

<h3>Set editors to UTF-8 (optional)</h3>
<ol>
	<li>Make shure that all files are saved with UTF-8 encoding. This is only essential if you are 
	working	with i18n.<br/>
		<img src="img/eclipse-utf8-01.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-02.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-03.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-04.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-05.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-06.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-07.png" style="width:700px; display:block;" />
		<img src="img/eclipse-utf8-08.png" style="width:700px; display:block;" />
	</li>
</ol>

<p>This ends the steps needed to prepare the Eclipse workspace for Maven and JBoss Tools. You need to 
go trough this steps every time you create a new workspace.</p>

<h2 id="import-project-into-eclipse">Import a Mavenized Seam Project into Eclipse</h2>
<p>m2eclipse provides three options for importing a Maven project into Eclipse including:</p>
<ul>
	<li>Import an existing Maven project from the local file sysytem</li>
	<li>Check out a Maven project from SCM</li>
	<li> Materialize a Maven project</li>
</ul>
<p>The options are described in detail in 
<a href="http://www.sonatype.com/products/maven/documentation/book-defguide">
Maven: The Definitive Guide</a>. This tutorial shows how to use the first option.</p>

<h3 id="import-an-existing-maven-project">
	Import An Existing Maven Project From the Local File System Into Eclipse
</h3>
<p>m2eclipse can import a Maven project with an existing pom.xml. By pointing at the
directory where a Maven project is located, m2eclipse detects all the Maven POMs
in the project and provides a hierarchical list of them.</p>

<ol class="vspace">
  <li>
		<a href="01-gettingstarted.html#use-as-template">Export</a> the <code>seam-refimpl</code> project 
		from svn to a folder of your choice, the <code>${SEAM_TUTORIAL}</code> folder. <br/>
	</li>
  <li>
		<a href="01-gettingstarted.html#modfy-the-poms">Modify the POMs</a> as needed.
	</li>
	<li>
		<a href="01-gettingstarted.html#switch-to-development-mode">Switch to development mode</a>.<br/>
		<strong>Remember</strong> to copy <code>${SEAM_TUTORIAL}/config/profiles/profiles.xml</code> to 
		the  project folder, <code>${SEAM_TUTORIAL}</code>. Modify the copy as needed; configure database 
		connection, point the server to the correct deploy folder (the <code>as.deploy</code> property
		in <code>profiles.xml</code> should correspond with the <code>configuration</code> folder you
		selected for the WTP server), etc.
	</li>
	<li>
		<a href="#how-to-configure-maven-eclipse-plugin-correctly">Make shure that the maven-eclipse 
		plugin is configured so that no extra code is generated during the import</a>.
	</li>
  <li>
    Import the project: In Eclipse select <code><strong>File>Import</strong></code> to import the project:
    <img src="img/eclipse-import.png" style="width:250px; display:block;" />
	</li>
	<li>
		Select <code><strong>General&gt;Maven Projects</strong></code> and click <strong>Next</strong>.
    <img src="img/eclipse-import-maven-01.png" style="width:340px; display:block;" />
	</li>
	<li>
		Browse to the folder where the project is located, select it, verify that all modules are checked 
		and click <strong>Finish</strong>.
    <img src="img/eclipse-import-maven-02.png" style="width:500px; display:block;" />
	</li>
	<li>
		You will notice a build error in the Maven console after the import:
		<img src="img/eclipse-import-maven-08.png" style="width:750px; display:block;" />
		<code><font color="red">
		Build errors for seam-tutorial-ear; org.apache.maven.lifecycle.LifecycleExecutionException: 
		Invalid or missing parameters: [Mojo parameter [name: 'outputDirectory'; alias: 'null'], Mojo 
		parameter [name: 'resources'; alias: 'null']] for mojo: 
		org.apache.maven.plugins:maven-resources-plugin:2.3:copy-resources</font></code><br/><br/>
		The build fail is caused by a conflict in Maven resolution and Workspace resolution as reported 
		here: <a href="http://jira.codehaus.org/browse/MNGECLIPSE-1136">
		Execution goals bound to the process-resources phase cause error</a><br/><br/>
		We fix :-)
	</li>
	<li>
    Modify Maven properties for the parent project, seam-tutotrial.<br/>
    <img src="img/eclipse-import-maven-07.png" style="width:350px; display:block;" />
    <img src="img/eclipse-project-properties-maven-01.png" style="width:580px; display:block;" />
		<strong>NOTE: <font color="red">DO NOT CHECK THE INCLUDE MODULES CHECKBOX - EVER!</font></strong>  
		Doing so will effectly block the possibility to use WTP to deploy your project. The selection is
		irreversible and you will have to remove the project from Eclipse, delete all Eclipse spesific
		settings in the project folders and set up the project from scratch. See the section 
		<a href="#remove-eclipse-settings">How To Completly Remove Eclipse Spesific Settings From a 
		Project</a> for how to completly remove Eclipse spesific settings from a project.
	</li>
	<li>
    Modify Maven properties for ear module; seam-tutotrial-ear. Uncheck the  <code>Skip Maven
		compiler plugin</code> checkbox:
    <img src="img/eclipse-project-properties-maven-02.png" style="width:580px; display:block;" />
	</li>
	<li>
    Modify Maven properties for ejb and war modules; seam-tutotrial-ejb and seam-tutotrial-war:
    <img src="img/eclipse-project-properties-maven-03.png" style="width:580px; display:block;" />
  </li>
</ol>
<p>Now we have fixed and the build errors should be gone :-))</p>

<h3>Project Facets for EAR, EJB and WAR Modules</h3>
<p>It should not be necessary to make any changes to the Project Facets, just verify that the 
facets are selected <strong>excactly</strong> as shown in the screenshots below. If they are not,
then you should delete the project from Eclipse,  
<a href="#remove-eclipse-settings">Completly Remove Eclipse Spesific Settings From the Project</a>
and then import the project all over again.
</p>
<ol>
	<li>EAR.<img src="img/eclipse-ear-facets.png" style="width:750px; display:block;" /></li>
  <li>EJB.<img src="img/eclipse-ejb-facets.png" style="width:750px; display:block;" /></li>
  <li>WAR.<img src="img/eclipse-war-facets.png" style="width:750px; display:block;" /></li>
</ol>


<h3>Create Maven Run Configurations</h3>
<ol class="vspace">
  <li>
    Create Maven <code>install -Pexplode</code> and a Maven <code>clean -Punexplode</code> 
		run configurations:<br/>
		The <code>install</code> goal with the <code>explode</code> profile is needed to do an initial 
		deploy to	the server and also to fix some WTP issues (more on that later). It is also reported 
		that the Maven install goal does not work properly from Eclipse. You should read 
		<a href="http://www-02.imixs.com:8081/roller/ralphsjavablog/entry/eclipse_maven_install_from_runas">
    this blog</a> and follow the screenshots 
		<a href="http://www-02.imixs.com:8081/roller/ralphsjavablog/entry/eclipse_maven_install_from_runas">
		there</a> and here to fix the problem.
    <img src="img/eclipse-run-configurations-01.png" style="width:640px; display:block;" />
		Below is the screenshot for the Maven <code>install -Pexplode</code> run configuration. Also 
		create a run configuration for the Maven <code>clean -Punexplode</code> goal. Remenber to use the
		external Maven Runtime you configured for the workspace.
    <img src="img/eclipse-run-configurations-02.png" style="width:640px; display:block;" />
		Running the goal should give the following output:<br/><br/>
		
		<div style="width:100%; overflow:hidden;">
		<pre style="font-size:9px">
[INFO] Executing tasks
     [echo] Exploding to C:/ide/server/jboss-4.2.3.GA/server/default/deploy/seam-tutorial-ear.ear
   [delete] Directory C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear cannot be removed using the file attribute.  Use dir instead.
     [sync] Copying 16 files to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear
     [sync] Copying C:\ide\projects\seam-tutorial\ear\target\seam-tutorial-ear-0.1-SNAPSHOT\seam-tutorial-war-0.1-SNAPSHOT.war\WEB-INF\jboss-web.xml to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\seam-tutorial-war-0.1-SNAPSHOT.war\WEB-INF\jboss-web.xml
     ....
     [sync] Copying C:\ide\projects\seam-tutorial\ear\target\seam-tutorial-ear-0.1-SNAPSHOT\seam-tutorial-war-0.1-SNAPSHOT.war\META-INF\maven\no.knowit.seam\seam-tutorial-war\pom.properties to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\seam-tutorial-war-0.1-SNAPSHOT.war\META-INF\maven\no.knowit.seam\seam-tutorial-war\pom.properties
     [sync] Copying C:\ide\projects\seam-tutorial\ear\target\seam-tutorial-ear-0.1-SNAPSHOT\META-INF\jboss-app.xml to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\META-INF\jboss-app.xml
[INFO] Executed tasks
[INFO] [install:install]
[INFO] Installing C:\ide\projects\seam-tutorial\ear\target\seam-tutorial-ear.ear to C:\Documents and Settings\Leif\.m2\repository\no\knowit\seam\seam-tutorial-ear\0.1-SNAPSHOT\seam-tutorial-ear-0.1-SNAPSHOT.ear
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] ------------------------------------------------------------------------
[INFO] seam-tutorial-parent .................................. SUCCESS [2.875s]
[INFO] seam-tutorial-ejb 0.1-SNAPSHOT ........................ SUCCESS [3.031s]
[INFO] seam-tutorial-war 0.1-SNAPSHOT ........................ SUCCESS [2.016s]
[INFO] seam-tutorial-ear 0.1-SNAPSHOT ........................ SUCCESS [7.703s]
[INFO] ------------------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------

		</pre>
		</div>
		You can run the goal(s) as needed by right clicking on the <strong>parent</strong> project and 
		select <code><strong>Run As &gt; Maven build</strong> </code> from the menu.
    <img src="img/eclipse-run-configurations-03.png" style="width:550px; display:block;" />
	</li>
	<li>
	  Start the server and verify that the deployment works:
    <img src="img/eclipse-server-view-start-server-01.png" style="width:250px; display:block;" />
		A successful deploy should look like this in the Console log:
    <img src="img/eclipse-server-view-start-server-02.png" style="width:750px; display:block;" />
	</li>
	<li>
		Open a browser and point the URL to <a href="http://localhost:8080/seam-tutorial">
		http://localhost:8080/seam-tutorial</a>
	</li>
	<li>
		Stop the server.
	</li>
</ol>

<h2>The Edit Compile Deploy Cycle</h2>
<p>To have an effective development environment we need to automate the edit compile deploy cycle.
You can either use WTP to deploy your project or you can define a Maven builder that 
hooks in to the <code>process-classes</code> goal. For the latter, the seam-refimpl POMs has alredy
defined an <code>explode</code> profile for the Maven process-classes goal. All you need to do is to
define a Maven builder that utilizes this profile on the <code>process-classes</code> goal.
</p>
<h3>WTP</h3>
<p>This section explains how to use WTP  <span style="display:none;">a.k.a. WTF</span> to 
deploy your project.</p>
<ol>
	<li>
		Open the <strong>JBoss Server View</strong> and add project to server.<br/>
		<img src="img/eclipse-wtp-01.png" style="width:280px; display:block;" />
		Ad the <code>seam-tutorial.ear</code> project and click <strong>Finish</strong>.
		<img src="img/eclipse-wtp-02.png" style="width:400px; display:block;" />
	</li>
	<li>
		Publish.<br/>
		<img src="img/eclipse-wtp-03.png" style="width:400px; display:block;" />
	</li>
	<li>
		Start the server and check the console output. 
		<img src="img/eclipse-server-view-start-server-01.png" style="width:250px; display:block;" />
		<font color="red">You will notice that the application failed to deploy</font>:
		<pre style="font-size:10px;">

12:48:30,813 INFO  [EARDeployer] Init J2EE application: file:/C:/dev/server/jboss-4.2.3.GA-jdk6/server/default/deploy/seam-tutorial-ear.ear/
12:48:30,814 ERROR [MainDeployer] Could not initialise deployment: file:/C:/dev/server/jboss-4.2.3.GA-jdk6/server/default/deploy/seam-tutorial-ear.ear/
org.jboss.deployment.DeploymentException: No META-INF/application.xml found
  at org.jboss.deployment.EARDeployer.init(EARDeployer.java:146)
  at org.jboss.deployment.MainDeployer.init(MainDeployer.java:872)
  at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:809)
  ....
  at org.jboss.Main$1.run(Main.java:508)
  at java.lang.Thread.run(Thread.java:619)
12:48:30,818 ERROR [URLDeploymentScanner] Incomplete Deployment listing:

--- Incompletely deployed packages ---
org.jboss.deployment.DeploymentInfo@716583c1 { url=file:/C:/dev/server/jboss-4.2.3.GA-jdk6/server/default/deploy/seam-tutorial-ear.ear/ }
  deployer: org.jboss.deployment.EARDeployer@1b7edd3
  status: null
  state: FAILED
  watch: file:/C:/dev/server/jboss-4.2.3.GA-jdk6/server/default/deploy/seam-tutorial-ear.ear/
  altDD: null
  lastDeployed: 1253443710814
  lastModified: 1253443587024
  mbeans:
		</pre>
	</li>
	<li>
		Stop the server and inspect the deploy folder. As you can see, the deploy folder contains a copy 
		of the WEB-INF folder from the WAR module and a couple of jar files that shouldn't be there. 
		Also the <code>*-ds.xml</code> file is missing. The problem is caused by this Eclipse bug:
		<a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=247090">
		Bug 247090 -  User)libraries incorrectly deployed within EARs</a>
		<img src="img/eclipse-wtp-04.png" style="width:400px; display:block;" />
	</li>
	<li>
		Select the parent project and run <code>mvn install -Pexplode</code> to fix the incorrect deploy.</br>
		<img src="img/eclipse-run-configurations-03.png" style="width:550px; display:block;" />
		<img src="img/eclipse-wtp-05.png" style="width:330px; display:block;" />
	</li>
	<li>
		Inspect the deploy folder and verify the the incorrectly deployed files are gone and that the 
		<code>*-ds.xml</code> file is present.
		<img src="img/eclipse-wtp-06.png" style="width:400px; display:block;" />
	</li>
	<li>
		Start the server (in debug mode) and check the console output.
		<img src="img/eclipse-server-view-start-server-01.png" style="width:250px; display:block;" />
		<pre style="font-size:10px;">
....
13:54:43,514 INFO  [EARDeployer] Started J2EE application: file:/C:/dev/server/jboss-4.2.3.GA-jdk6/server/default/deploy/seam-tutorial-ear.ear/
13:54:43,562 INFO  [Http11Protocol] Starting Coyote HTTP/1.1 on http-localhost%2F127.0.0.1-8080
13:54:43,571 INFO  [AjpProtocol] Starting Coyote AJP/1.3 on ajp-localhost%2F127.0.0.1-8009
13:54:43,576 INFO  [Server] JBoss (MX MicroKernel) [4.2.3.GA (build: SVNTag=JBoss_4_2_3_GA date=200807181439)] Started in 14s:340ms
		</pre>
	</li>
	<li>
		You can check that the WTP works by changing some xhtml and java files. The changes should be 
		reflected immediately on the server (after WTP has done a publish). But as you probably 
		know; not all changes to Java code are hot deployable even in debug mode. If hot code replacement 
		is important to you (and it	should be) then get a copy of <strong>JRebel</strong> from 
		<a href="http://www.zeroturnaround.com/jrebel/">ZERO TURNAROUND</a>.
	</li>
	<li>
		You need to keep an eye on the deploy folder as WTP will do a full deploy from time to time, in
		particular when you make modifications to the EAR module. Then the fix is to stop the server and
		run <code>mvn install -Pexplode</code> again.
	</li>
	<li>
		<strong>Important:</strong> The child pom's <code>&lt;relativePath&gt;</code> tag must point to 
		the parent pom. If it don't, the child pom will pick up the parent pom from your local .m2 repo 
		and will be missing profiles and property values activated trough the parent pom's 
		<code>profiles.xml</code>.
		<pre style="font-size:9px;">
		
&lt;parent&gt;
  &lt;groupId&gt;no.knowit.seam&lt;/groupId&gt;
  &lt;artifactId&gt;seam-refimpl&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  <strong><font color="blue">&lt;relativePath&gt;../pom.xml&lt;/relativePath&gt;</font></strong>
&lt;/parent&gt;
		</pre>
	</li>
</ol>

<h3>Maven Builder</h3>
<p>As an alternative to WTP you can create a Maven builder that hooks in to the 
<code>process-classes</code> goal. The Maven builder will then take care of the incremental 
deployment. In combination with the <code style="white-space:nowrap">mvn install -Pexplode</code>
goal you will have a complete <strong>compile- build- deploy</strong> environment without WTP.</p>
<ol>
	<li>
	  Configure the Maven Builder.<br/>
		The Maven builder executes the <code>explode</code> profile on the <code>process-classes</code> 
		goal. The child poms will "inherit" this builder, so you only need to define the builder on the
		parent project.
    <img src="img/eclipse-import-maven-07.png" style="width:350px; display:block;" />
    <img src="img/eclipse-maven-builder-01.png" style="width:500px; display:block;" />
    <img src="img/eclipse-maven-builder-02.png" style="width:400px; display:block;" />
		<strong>Note</strong>: Experiment with the <code>Base directory</code> variable. If you use the 
		<code>${project_loc}</code> variable then the builder will run only on the sub project that 
		contains the modified file - resulting in a faster build cycle.
    <img src="img/eclipse-maven-builder-03.png" style="width:500px; display:block;" />
	</li>
	<li>
		Run <code>mvn install -Pexplode</code> to do an initial deploy.</br>
		<img src="img/eclipse-run-configurations-03.png" style="width:550px; display:block;" />
		<img src="img/eclipse-wtp-05.png" style="width:330px; display:block;" />
	</li>
	<li>
		Test the Builder:<br/>
		Open a java class, e.g. <code>Authenticator.java</code>. Modify the source, save and check
		the console output:
		<div style="overflow:hidden;">
		<pre style="font-size:9px">
...
[INFO] [antrun:run {execution: ejb-process-classes}]
[INFO] Executing tasks
     [copy] Copying 1 file to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\seam-tutorial-ejb-0.1-SNAPSHOT.jar
     [copy] Copying C:\ide\projects\seam-tutorial\ejb\target\classes\org\jboss\seam\example\session\<font color="blue">Authenticator.class</font> to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\seam-tutorial-ejb-0.1-SNAPSHOT.jar\org\jboss\seam\example\session\Authenticator.class
[INFO] Executed tasks
...</pre>
		Open a xhtml file, e.g. <code>home.xhtml</code>. Modify the source, save and check
		the console output:
		<pre style="font-size:9px">
...
[INFO] [antrun:run {execution: war-process-classes}]
[INFO] Executing tasks
     [copy] Copying 1 file to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\seam-tutorial-war-0.1-SNAPSHOT.war
     [copy] Copying C:\ide\projects\seam-tutorial\war\src\main\webapp\<font color="blue">home.xhtml</font> to C:\ide\server\jboss-4.2.3.GA\server\default\deploy\seam-tutorial-ear.ear\seam-tutorial-war-0.1-SNAPSHOT.war\home.xhtml
[INFO] Executed tasks
...</pre>
		Check the Maven console as well:
		<pre style="font-size:9px; color:blue;">
... Maven Builder: AUTO_BUILD 
... C:\ide\projects\seam-tutorial
... Build type auto : process-classes
...  mvn -Pexplode -B -Dmaven.test.skip=true -s "C:\Documents and Settings\Leif\.m2\settings.xml" process-classes
... Build type auto : process-classes
... Maven Builder: AUTO_BUILD 
... Maven Builder: AUTO_BUILD 
... C:\ide\projects\seam-tutorial
... Build type auto : process-classes
...  mvn -Pexplode -B -Dmaven.test.skip=true -s "C:\Documents and Settings\Leif\.m2\settings.xml" process-classes
... Build type auto : process-classes</pre>
		</div>
	</li>
	<li>
		As you probably know; not all changes to Java code are hot deployable even in debug mode. If hot 
		code replacement is important to you (and it	should be) then get a copy of <strong>JRebel</strong> 
		from <a href="http://www.zeroturnaround.com/jrebel/">ZERO TURNAROUND</a>.
	</li>	
	<li>
		<strong>Important:</strong> The child pom's <code>&lt;relativePath&gt;</code> tag must point to 
		the parent pom. If it don't, the child pom will pick up the parent pom from your local .m2 repo 
		and will be missing profiles and property values activated trough the parent pom's 
		<code>profiles.xml</code>.
		<pre style="font-size:9px;">
		
&lt;parent&gt;
  &lt;groupId&gt;no.knowit.seam&lt;/groupId&gt;
  &lt;artifactId&gt;seam-refimpl&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  <strong>&lt;relativePath&gt;../pom.xml&lt;/relativePath&gt;</strong>
&lt;/parent&gt;
		</pre>
	</li>
</ol>

<h3>Don't Kill One Bird with Two Stones</h3>
<p>Choose either to add the project to the WTP server or define a Maven builder.</p>

<h2>JBoss Tools</h2>
<p>JBoss Tools is a perfect match for Seam devolpers using Maven and the Elipse IDE. It helps you 
with a a lot of tasks you otherwise would have used hours and days to complete.
The Tools is not essential for developing a Mavenized Seam application, but it provides a collection 
of tools that help you generate code and develop in an incremental manner. The JBossTools project 
hosts a variety of standalone Eclipse plug-ins that support Java EE development. You can use the 
tools to do reverse engeneering: If you have an existing database then the Tools can generate a full 
CRUD application with entities, Seam framework classes (home- and list classes) and a user interface 
with navigation and drilldown. If you use the Tools to create an entity class then the Tools will 
automatically generate the corresponding Seam framework classes and userinterface (list and a detail 
page). 
</p>
<p>JBoss tools is a Eclipse feature, that can be enabled on a project by adding some configuration 
(JSF and Seam facets, the SeamBuilder and SeamNature) to the Eclipse project. JBoss Tools will 
manage two projects: the WAR and the EJB project, but the WAR project will be the main source of 
configuration. By adding the necessary items to the maven-eclipse-plugin configuration for this 
project and also adding a special Seam configuration file to the .settings directory, JBoss tools 
will recognize the project correctly. For some reason, JBoss tools also stores some configuration in 
the workspace configuration. This can not be configured from the Maven Archetype and thus the JBoss 
Tools configuration is not complete. Because of this, the link between the WAR and EJB project will 
not be found by JBoss Tools from the EJB project. When a new Seam Artifact (Action, Entity, Form or 
Conversation) is added from the EJB project context menu, the configurations made in the WAR project 
are not picked up. When adding from the WAR project they are picked up and some sources will also be 
written in the EJB projects, as required (source: 
<a href="http://blog.xebia.com/2009/06/06/configuring-a-seam-ejb-project-for-development-with-maven-and-jboss-tools/">
	Configuring a Seam EJB project for development with Maven and JBoss Tools
</a>).
</p>
<p>If you really want to learn the mecanisms behind Seam, then it is definitively worth the effort 
setting up the tools. Play with the tools and study the code that the various tools generates.
</p>

<h3>Configure JBoss Tools For The Workspace</h3>
<p>Unpack <a href="http://www.seamframework.org/Download">JBoss Seam</a> to a folder of your 
choice, e.g. <code>C:/ide/libs/jboss-seam-2.2.0.GA</code>. Open <code><strong>Prefereneces
</strong></code> and follow the screenshots.</p>
<ol class="vspace">
  <li>
		JSF:
		<img src="img/eclipse-jboss-tools-01.png" style="width:650px; display:block;" />
	</li>
	<li>
		Seam runtime:
		<img src="img/eclipse-jboss-tools-02.png" style="width:650px; display:block;" />
		<img src="img/eclipse-jboss-tools-03.png" style="width:650px; display:block;" />
	</li>
</ol>

<!--
<h3> Define a Data Source</h3>
<p>If you plan to use JBoss Tools to do reverse engeneering, then you need to define and connect to
a datasource. The screenshots below outlines one possible way to accomplish this.</p>
<ol class="vspace">
  <li>Download and install necessary software: 
  <ul>
    <li><a href="http://dev.mysql.com/downloads/">MySql5+</a></li>
    <li><a href="http://dev.mysql.com/downloads/connector/j/5.0.html">MySql connector</a></li>
  </ul>
  </li>
  <li>Copy mysql-connector-java-*-bin.jar to <code>${JBOSS_CONFIG}/lib</code> (delete any other 
      mysql-connector-java-*-bin.jar file if exist).
  </li>
  <li>
    Start the database server and create schema <code>"refimpl_db"</code>, use e.g. the MySql Administrator GUI.<br/>
    Or, if you are a MySql macho, you can type the following SQL DDL by hand:<br style="margin-bottom:.6em;" />
    <code><strong>CREATE DATABASE refimpl_db CHARACTER SET utf8 COLLATE utf8_general_ci;</strong></code><br/>
    <strong>Note:</strong> Allways use UTF8 for i18n.
  </li>
	
	<li>
		In Preferences, navigate to <code><strong>Data Management>Connectivity>Driver Definitions</strong></code>.
		Click <strong>Add...</strong> to add a new driver.
		<img src="img/eclipse-data-management-01.png" style="width:750px; display:block;" />
		<img src="img/eclipse-data-management-02.png" style="width:490px; display:block;" />
		<img src="img/eclipse-data-management-03.png" style="width:490px; display:block;" />
		<img src="img/eclipse-data-management-04.png" style="width:490px; display:block;" />
	</li>
	<li>
		Open the <code><strong>Database Development</strong></code> perspective. In 
		<code><strong>Data Source Explorer</strong></code> 
		right click the <code><strong>Databases</strong></code> folder and select 
		<code><strong>New...</strong></code>
		<img src="img/eclipse-data-source-explorer-01.png" style="width:190px; display:block;" />
		<img src="img/eclipse-connection-profile-01.png" style="width:420px; display:block;" />
		<img src="img/eclipse-connection-profile-02.png" style="width:420px; display:block;" />
		<img src="img/eclipse-data-source-explorer-02.png" style="width:300px; display:block;" />
	</li>
</ol>
-->


<h3 id="configure-jboss-tools-for-a-project">Configure JBoss Tools For a Project</h3>
<p>JBoss Tools will manage two projects: the WAR and the EJB project. The WAR project will be 
the main source of configuration, so we'll start with the WAR.</p>
<ol class="vspace">
	<li>
	  The WAR module:
    <img src="img/eclipse-war-properties-07.png" style="width:650px; display:block;" />
    <img src="img/eclipse-war-properties-08.png" style="width:650px; display:block;" />
    <img src="img/eclipse-war-properties-09.png" style="width:650px; display:block;" />
	</li>
	<li>
	  The EJB module:
    <img src="img/eclipse-ejb-properties-01.png" style="width:650px; display:block;" />
	</li>
	<li>
	  The EAR module:<br/>
		Should not be necessary to do anything here in connection with the Tools. Use default values.
	</li>
	<li>
	  The parent module:<br/>
		Should not be necessary to do anything here in connection with the Tools. Use default values.
	</li>
	<li>
		That's it. You're now ready to play with the tools :-)
	</li>
</ol>

<h2 id="play-with-the-jboss-tools">Play With The JBoss Tools</h2>
<p>In this section we'll play with the tools.</p>

<h3 id="entity-bean-the-seam-way">Create an Entity Bean the Seam Way</h3>
<ol class="vspace">
<li>
	Configure <code>profiles.xml</code>:
	<pre>

&lt;profilesXml&gt;
  &lt;profiles&gt;
  .
  .
  &lt;!-- MySql5 --&gt;
  &lt;profile&gt;
    &lt;id&gt;ds-mysql5&lt;/id&gt;
    .
      <font color="blue">&lt;ds.database.name&gt;refimpl_db&lt;/ds.database.name&gt;</font>
    .
  &lt;/profile&gt;
  .
  &lt;!-- jboss-4.2.3 --&gt;
  &lt;profile&gt;
    &lt;id&gt;as-jboss423&lt;/id&gt;
    .
      <font color="blue">&lt;as.home&gt;C:/dev/server/jboss-4.2.3.GA-jdk6&lt;/as.home&gt;</font>
      <font color="blue">&lt;as.deploy&gt;${as.home}/server/default/deploy&lt;/as.deploy&gt;</font>
    .
  &lt;/profile&gt;
  .
  &lt;!-- development environment --&gt;
  &lt;profile&gt;
    &lt;id&gt;env-dev&lt;/id&gt;
    .
      <font color="blue">&lt;env.hibernate.hbm2ddl.auto&gt;update&lt;/env.hibernate.hbm2ddl.auto&gt;</font>
    .
  &lt;/profile&gt;
  &lt;/profiles&gt;

  <font color="blue">&lt;activeProfiles&gt;
    &lt;activeProfile&gt;env-dev&lt;/activeProfile&gt;
    &lt;activeProfile&gt;ds-mysql5&lt;/activeProfile&gt;  
    &lt;activeProfile&gt;as-jboss423&lt;/activeProfile&gt;
  &lt;/activeProfiles&gt;</font>
&lt;/profilesXml&gt;
	</pre>	
</li>
<li>
	Open Seam perspective.
	<img src="img/eclipse-perspective-seam.png" style="width:250px; display:block;" />
</li>
<li>
	In Package Explorer, right click on the <strong>war</strong> or <strong>ejb</strong> project and 
	select <code><strong>New>Seam Entity</strong></code>
	<img src="img/eclipse-seam-entity-01.png" style="width:500px; display:block;" />
</li>
<li>
	Fill in the <strong>Seam entity class name</strong>, e.g. <code>MyEntity</code>, and click 
	<strong>Finish</strong><br/>.
	<img src="img/eclipse-seam-entity-02.png" style="width:400px;" class="inline-block" />
	<img src="img/eclipse-seam-entity-03.png" style="width:400px;" class="inline-block" />
</li>
<li>
	Generated code:
	<img src="img/eclipse-seam-entity-04.png" style="width:350px; display:block;" />

	All this code in less than ten seconds! :-))<br/>

	<div class="code-frame">
		<code><strong>MyEntity.java</strong></code>
		<iframe frameborder="0" src="./code-listings/MyEntity.java.html"></iframe>
	</div>
	
	<div class="code-frame">
		<code><strong>MyEntityHome.java</strong></code>
		<iframe frameborder="0" src="./code-listings/MyEntityHome.java.html"></iframe>
	</div>
	
	<div class="code-frame">
		<code><strong>MyEntityList.java</strong></code>
		<iframe frameborder="0" style="height:220px;" src="./code-listings/MyEntityList.java.html"></iframe>
	</div>
	
	<div class="code-frame">
		<code><strong>myEntityList.xhtml</strong></code>
		<iframe frameborder="0" src="./code-listings/myEntityList.xhtml.html"></iframe>
	</div>
	
	<div class="code-frame">
		<code><strong>myEntity.xhtml</strong></code>
		<iframe frameborder="0" src="./code-listings/myEntity.xhtml.html"></iframe>
	</div>
</li>
<li>
  We're almost there. We configured <strong>Seam Settings</strong> to generate <code>xhtml</code> 
	files to the <code>webapp/view</code> folder, but the code generator does not take this into 
	account. The links in the generated <code>xhtml</code> code "assumes" that the code is generated
	to the <code>webapp</code> folder. So, to finish up, we fix this flaw by making some small changes 
	to the genereated <code>xhtml</code> code. Also add a link to <code>myEntityList.xhtml</code> in 
	<code>menu.xhtml</code> (<font color="blue">see the blue text</font>).
	<ul>
	<li>
	<code><strong>myEntityList.xhtml</strong></code>
	<pre style="font-size:10px;">
&lt;!DOCTYPE composition PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;ui:composition xmlns=&quot;http://www.w3.org/1999/xhtml&quot;
    xmlns:s=&quot;http://jboss.com/products/seam/taglib&quot;
    xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;
    xmlns:f=&quot;http://java.sun.com/jsf/core&quot;
    xmlns:h=&quot;http://java.sun.com/jsf/html&quot;
    xmlns:rich=&quot;http://richfaces.org/rich&quot;
    <font color="blue">template=&quot;/layout/template.xhtml&quot;&gt;</font>

&lt;ui:define name=&quot;body&quot;&gt;
    &lt;rich:panel&gt;
        &lt;f:facet name=&quot;header&quot;&gt;myEntityList&lt;/f:facet&gt;
        &lt;div class=&quot;results&quot;&gt;
            &lt;h:outputText value=&quot;No myEntity exists&quot;
                       rendered=&quot;#{empty myEntityList.resultList}&quot;/&gt;
            &lt;h:dataTable id=&quot;myEntityList&quot; var=&quot;myEntity&quot;
                      value=&quot;#{myEntityList.resultList}&quot;
                   rendered=&quot;#{not empty myEntityList.resultList}&quot;&gt;
                &lt;h:column&gt;
                    &lt;f:facet name=&quot;header&quot;&gt;Id&lt;/f:facet&gt;
                    #{myEntity.id}
                &lt;/h:column&gt;
                &lt;h:column&gt;
                    &lt;f:facet name=&quot;header&quot;&gt;Name&lt;/f:facet&gt;
                    &lt;s:link id=&quot;myEntity&quot;
                         value=&quot;#{myEntity.name}&quot;
                   propagation=&quot;none&quot;
                         <font color="blue">view=&quot;/view/myEntity.xhtml&quot;&gt;</font>
                        &lt;f:param name=&quot;myEntityId&quot;
                                value=&quot;#{myEntity.id}&quot;/&gt;
                    &lt;/s:link&gt;
                &lt;/h:column&gt;
            &lt;/h:dataTable&gt;
        &lt;/div&gt;
    &lt;/rich:panel&gt;
    &lt;div class=&quot;actionButtons&quot;&gt;
        &lt;s:button id=&quot;done&quot;
               value=&quot;Create myEntity&quot;
                <font color="blue">view=&quot;/view/myEntity.xhtml&quot;/&gt;</font>
    &lt;/div&gt;
&lt;/ui:define&gt;
&lt;/ui:composition&gt;
	</pre>
	</li>
	<li>
	<code><strong>myEntity.xhtml</strong></code>
	<pre style="font-size:10px;">
&lt;!DOCTYPE composition PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;ui:composition xmlns=&quot;http://www.w3.org/1999/xhtml&quot;
    xmlns:s=&quot;http://jboss.com/products/seam/taglib&quot;
    xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;
    xmlns:f=&quot;http://java.sun.com/jsf/core&quot;
    xmlns:h=&quot;http://java.sun.com/jsf/html&quot;
    xmlns:rich=&quot;http://richfaces.org/rich&quot;
    <font color="blue">template=&quot;/layout/template.xhtml&quot;&gt;</font>

&lt;ui:define name=&quot;body&quot;&gt;
    &lt;h:form id=&quot;myEntityForm&quot;&gt;
        &lt;rich:panel&gt;
            &lt;f:facet name=&quot;header&quot;&gt;myEntity&lt;/f:facet&gt;
            <font color="blue">&lt;s:decorate id=&quot;nameField&quot; template=&quot;/layout/edit.xhtml&quot;&gt;</font>
                &lt;ui:define name=&quot;label&quot;&gt;Name&lt;/ui:define&gt;
                &lt;h:inputText id=&quot;name&quot; required=&quot;true&quot;
                             value=&quot;#{myEntityHome.instance.name}&quot;/&gt;
            &lt;/s:decorate&gt;
            &lt;div style=&quot;clear:both&quot;/&gt;
        &lt;/rich:panel&gt;
        &lt;div class=&quot;actionButtons&quot;&gt;
            &lt;h:commandButton id=&quot;save&quot;
                          value=&quot;Save&quot;
                         action=&quot;#{myEntityHome.persist}&quot;
                       rendered=&quot;#{!myEntityHome.managed}&quot;/&gt;
            &lt;h:commandButton id=&quot;update&quot;
                          value=&quot;Save&quot;
                         action=&quot;#{myEntityHome.update}&quot;
                       rendered=&quot;#{myEntityHome.managed}&quot;/&gt;
            &lt;h:commandButton id=&quot;delete&quot;
                          value=&quot;Delete&quot;
                         action=&quot;#{myEntityHome.remove}&quot;
                      immediate=&quot;true&quot;
                       rendered=&quot;#{myEntityHome.managed}&quot;/&gt;
            &lt;s:button propagation=&quot;end&quot;
                               id=&quot;cancel&quot;
                            value=&quot;Cancel&quot;
                             <font color="blue">view=&quot;/view/myEntityList.xhtml&quot;/&gt;</font>
        &lt;/div&gt;
    &lt;/h:form&gt;
&lt;/ui:define&gt;
&lt;/ui:composition&gt;
	</pre>
	</li>
	<li>
	<code><strong>menu.xhtml</strong></code>
	<pre style="font-size:10px;">
&lt;rich:toolBar
    xmlns=&quot;http://www.w3.org/1999/xhtml&quot;
    xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;
    xmlns:h=&quot;http://java.sun.com/jsf/html&quot;
    xmlns:f=&quot;http://java.sun.com/jsf/core&quot;
    xmlns:s=&quot;http://jboss.com/products/seam/taglib&quot;
    xmlns:rich=&quot;http://richfaces.org/rich&quot;&gt;
    &lt;rich:toolBarGroup&gt;
      &lt;h:outputText value=&quot;#{projectName}:&quot;/&gt;
      &lt;s:link view=&quot;/home.xhtml&quot; value=&quot;Home&quot; propagation=&quot;none&quot;/&gt;
    &lt;/rich:toolBarGroup&gt;

    &lt;!-- @newMenuItem@ --&gt;
    &lt;s:link view=&quot;/view/example/userList.xhtml&quot;
      value=&quot;User List&quot;
      includePageParams=&quot;false&quot;
      propagation=&quot;none&quot;/&gt;
    
    <font color="blue">&lt;s:link view=&quot;/view/myEntityList.xhtml&quot;
      value=&quot;myEntity List&quot;
      includePageParams=&quot;false&quot;
      propagation=&quot;none&quot;/&gt;</font>
    
    &lt;rich:toolBarGroup location=&quot;right&quot;&gt;
      &lt;h:outputText value=&quot;signed in as: #{identity.username}&quot; rendered=&quot;#{identity.loggedIn}&quot;/&gt;
      &lt;s:link view=&quot;/login.xhtml&quot; 
        value=&quot;Login&quot; 
        rendered=&quot;#{not identity.loggedIn}&quot; 
        propagation=&quot;none&quot;/&gt;
      &lt;s:link view=&quot;/home.xhtml&quot; 
        action=&quot;#{identity.logout}&quot; 
        value=&quot;Logout&quot; 
        rendered=&quot;#{identity.loggedIn}&quot; 
        propagation=&quot;none&quot;/&gt;
    &lt;/rich:toolBarGroup&gt;
&lt;/rich:toolBar&gt;
	</pre>
	</li>
	</ul>
	</li>
	<li>
		That's it! Run <code>mvn install -Pexplode</code> to do an initial deploy, start server and 
		point your browser to 
		<a href="http://localhost:8080/seam-tutorial/">http://localhost:8080/seam-tutorial/</a>
		<img src="img/eclipse-run-configurations-03.png" style="width:550px; display:block;" />
		<img src="img/eclipse-wtp-05.png" style="width:330px; display:block;" />
		<img src="img/eclipse-seam-entity-05.png" style="width:600px; display:block;" />
	</li>
</ol>

<h3 id="done-in-60-seconds">Reverse Engeneering - Done in 60 Seconds!</h3>
<p>Well, the tutorial is not done in 60 seconds, but the revrese engeneering is.</p>
<p>We will re-use the project from the <a href="#entity-bean-the-seam-way">previous section</a>, so
complete that tutorial first.</p>
<h4>Configure Database</h4>
<ol class="vspace">
<li>
	Checkout or export the sql scripts <code>open18-initial-schema-mysql.sql</code> and 
	<code>open18-initial-seed-data-mysql.sql</code> from svn,  
	<a href="http://seam-maven-refimpl.googlecode.com/svn/trunk/samples/seaminaction/etc/schema/">
		http://seam-maven-refimpl.googlecode.com/svn/trunk/samples/seaminaction/etc/schema/</a>.
</li>
<li>
	Open e.g. MySQL Query Browser and create schema <code>refimpl_db</code>.
	<img src="img/eclipse-seam-db-entity-01.png" style="width:700px; display:block;" />
</li>
<li>
	Open script, <code>open18-initial-schema-mysql.sql</code> and click <strong>execute</strong>.
	<img src="img/eclipse-seam-db-entity-02.png" style="width:700px; display:block;" />
	<img src="img/eclipse-seam-db-entity-05.png" style="width:500px; display:block;" />
	<img src="img/eclipse-seam-db-entity-03.png" style="width:700px; display:block;" />
</li>
<li>
	Open script, <code>open18-initial-seed-data-mysql.sql</code> and click <strong>execute</strong>.
	<img src="img/eclipse-seam-db-entity-04.png" style="width:700px; display:block;" />
</li>
</ol>

<h4>Create and Configure Database Connection</h4>
<ol class="vspace">
<li>
	Open the <strong>Database Development</strong> perspective.
	<img src="img/eclipse-seam-db-entity-07.png" style="width:300px; display:block;" />
</li>
<li>
	Create a new Database Connection.
	<img src="img/eclipse-seam-db-entity-16.png" style="width:300px; display:block;" />
	<img src="img/eclipse-seam-db-entity-09.png" style="width:400px;" class="inline-block" />
	<img src="img/eclipse-seam-db-entity-10.png" style="width:460px;" class="inline-block" />
	<br/>
	<img src="img/eclipse-seam-db-entity-11.png" style="width:400px;" class="inline-block" />
	<img src="img/eclipse-seam-db-entity-12.png" style="width:400px;" class="inline-block" />
	<br/>
	<img src="img/eclipse-seam-db-entity-13.png" style="width:400px;" class="inline-block" />
	<img src="img/eclipse-seam-db-entity-14.png" style="width:400px;" class="inline-block" />
	<br/>
	<img src="img/eclipse-seam-db-entity-15.png" style="width:400px;"  class="inline-block" />
	<img src="img/eclipse-seam-db-entity-17.png" style="width:400px; vertical-align:bottom"  class="inline-block" />
	<br/>
	<img src="img/eclipse-seam-db-entity-19.png" style="width:350px; display:block;" />
</li>
</ol>

<h4>Add Hibernate Configuration</h4>
<ol class="vspace">
<li>
	Open the <strong>Hibernate</strong> perspective.
	<img src="img/eclipse-seam-db-entity-21.png" style="width:300px; display:block;" />
</li>
<li>
	Right click inside explorer and select <code><strong>Add Configuration...</strong></code>
	<img src="img/eclipse-seam-db-entity-22.png" style="width:300px; display:block;" />
</li>
<li>
	Add the newly created connection and define a Database dialect.<br/>
	<img src="img/eclipse-seam-db-entity-23.png" style="width:350px;" class="inline-block" />
	<img src="img/eclipse-seam-db-entity-24.png" style="width:350px;" class="inline-block" />
	<br/>
	<img src="img/eclipse-seam-db-entity-25.png" style="width:300px; display:block;" />
</li>
</ol>

<h4>Modify project</h4>
<ol class="vspace">
<li>
	Open the <strong>Seam</strong> perspective.
	<img src="img/eclipse-perspective-seam.png" style="width:300px; display:block;" />
</li>
<li>
	Modify the <code>seam-tutorial</code> project.
	<ul>
	<li>
		In <code>seam-tutorial-ejb</code>; delete all packages except for the 
		<code><strong>org.jboss.seam.example.action</strong></code> package.
	</li>
	<li>
		In <code>seam-tutorial-war</code>; delete the <code><strong>view</strong></code> folder. 
	</li>
	</ul>
	<img src="img/eclipse-seam-db-entity-06.png" style="width:300px; display:block;" />
</li>
<li>
	Modify <code><strong>menu.xhtml</strong></code>.
	<pre>
&lt;rich:toolBar
  xmlns=&quot;http://www.w3.org/1999/xhtml&quot;
  xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;
  xmlns:h=&quot;http://java.sun.com/jsf/html&quot;
  xmlns:f=&quot;http://java.sun.com/jsf/core&quot;
  xmlns:s=&quot;http://jboss.com/products/seam/taglib&quot;
  xmlns:rich=&quot;http://richfaces.org/rich&quot;&gt;
  &lt;rich:toolBarGroup&gt;
    &lt;h:outputText value=&quot;#{projectName}:&quot;/&gt;
    &lt;s:link id=&quot;menuHomeId&quot; 
      view=&quot;/home.xhtml&quot; 
      value=&quot;Home&quot; 
      propagation=&quot;none&quot;/&gt;
  &lt;/rich:toolBarGroup&gt;

  &lt;!-- @newMenuItem@ --&gt;
  &lt;rich:toolBarGroup location=&quot;right&quot;&gt;
    &lt;h:outputText id=&quot;menuWelcomeId&quot;
      value=&quot;signed in as: #{credentials.username}&quot;
      rendered=&quot;#{identity.loggedIn}&quot; /&gt;
    &lt;s:link id=&quot;menuLoginId&quot; 
      view=&quot;/login.xhtml&quot; 
      value=&quot;Login&quot;
      rendered=&quot;#{not identity.loggedIn}&quot; 
      propagation=&quot;none&quot; /&gt;
    &lt;s:link id=&quot;menuLogoutId&quot; 
      view=&quot;/home.xhtml&quot;
      action=&quot;#{identity.logout}&quot; 
      value=&quot;Logout&quot;
      rendered=&quot;#{identity.loggedIn}&quot; 
      propagation=&quot;none&quot; /&gt;
  &lt;/rich:toolBarGroup&gt;
&lt;/rich:toolBar&gt;
	</pre>	
</li>
<li>
	Modify Seam settings for WAR: Select the newly created connection and point the View folder to 
	<strong>/seam-tutorial-war/src/main/webapp</strong> so that xhtml files are generated to the
	webapp folder.
	<img src="img/eclipse-seam-db-entity-08.png" style="width:650px; display:block;" />
</li>
<li>
	Modify Seam settings for EJB.
	<img src="img/eclipse-seam-db-entity-18.png" style="width:650px; display:block;" />
</li>
<li>
  For some reason the reverse engeneering tool need a clean compiled project to do the reverse
	engeneering, so run e.g. <code><strong>mvn clean package</strong></code> on the parent project.
	<img src="img/eclipse-seam-db-entity-20.png" style="width:600px; display:block;" />
</li>
</ol>

<h4>Generate Entities From Existing Database</h4>
<ol class="vspace">
<li>
	Open the <strong>Seam</strong> perspective.
	<img src="img/eclipse-perspective-seam.png" style="width:250px; display:block;" />
</li>
	In Package Explorer, right click on the <strong>war</strong> or <strong>ejb</strong> project and 
	select <code><strong>New>Seam Generate Entities</strong></code>
	<img src="img/eclipse-seam-db-entity-31.png" style="width:650px; display:block;" />
	<br/>
	<img src="img/eclipse-seam-db-entity-32.png" style="width:450px;" class="inline-block" />
	<img src="img/eclipse-seam-db-entity-33.png" style="width:450px;" class="inline-block" />
</li>
<li>
	Now, sit back and watch the magic happen.<br/>
	<img src="img/eclipse-seam-db-entity-34.png" style="width:300px;" class="inline-block" />
	<img src="img/eclipse-seam-db-entity-35.png" style="width:300px;" class="inline-block" />
</li>
<li>
	Run <code>mvn install -Pexplode</code>, start server and point your browser to 
	<a href="http://localhost:8080/seam-tutorial/">http://localhost:8080/seam-tutorial/</a>
	<img src="img/eclipse-run-configurations-03.png" style="width:550px; display:block;" />
	<img src="img/eclipse-wtp-05.png" style="width:330px; display:block;" />
	<img src="img/eclipse-seam-db-entity-36.png" style="width:700px;" class="inline-block" />
</li>
<li>
	A full enterprise CRUD application with basic security generated, deployed and up an running in 
	about 60 seconds.	That's impressing! 
</li>
<li>
	As you browse trough the pages you will find that that the <code></strong>TeeList</strong></code>
	page fails to load. The problem is desctibed here: 
	<a href="http://seam-maven-refimpl.googlecode.com/svn/trunk/samples/seaminaction/stages/projects-ch04/chapter-developments.txt">
	http://seam-maven-refimpl.googlecode.com/svn/trunk/samples/seaminaction/stages/projects-ch04/chapter-developments.txt</a>.
	A solution is found here: 
	<a href="http://seam-maven-refimpl.googlecode.com/svn/trunk/samples/seaminaction/stages/projects-ch05/chapter-developments.txt">
	http://seam-maven-refimpl.googlecode.com/svn/trunk/samples/seaminaction/stages/projects-ch05/chapter-developments.txt</a>.
	</p>
</li>
</ol>

<h2>How To's</h2>
<h3 id="checkout-trunk-from-eclipse">How To Checkout Trunk From Eclipse</h3>
<ol>
  <li>
    In Eclipse select <code><strong>File>Import</strong></code> to import the trunk:
    <img src="img/eclipse-import.png" style="width:250px; display:block;" />
	</li>
	<li>
		Select <code><strong>Checkout Projects from SVN</strong></code> and click <strong>Next</strong>.
    <img src="img/eclipse-checkout-projects-from-svn.png" style="width:450px; display:block;" />
	</li>
	<li>
		Select an existing repository location and click <strong>Next</strong>.
    <img src="img/eclipse-checkout-projects-from-svn-select-location.png" style="width:450px; display:block;" />
	</li>
	<li>
		Select the folder to be checked out from SVN and click <strong>Next</strong>.
    <img src="img/eclipse-checkout-projects-from-svn-select-folder.png" style="width:450px; display:block;" />
	</li>
	<li>
		Select <code><strong>Check out as a project in the workspace</strong></code>  and click 
		<strong>Next</strong>.
    <img src="img/eclipse-checkout-projects-from-svn-check-out-as.png" style="width:450px; display:block;" />
	</li>
	<li>
		Uncheck the <code><strong>Use default workspace location</strong></code> checkbox and
		browse to the folder where you want to check out the trunk. <br/><strong>Note:</strong> 
		<a href="#configure-the-workspace">Do not add Maven projects under your workspace folder</a>.<br/><br/>
		Click <strong>Finish</strong>.<br/>
    <img src="img/eclipse-checkout-projects-from-svn-checkout-as.png" style="width:450px; display:block;" />
	</li>
	<li>
		You should now have access to the complete trunk from Eclipse.
    <img src="img/eclipse-checkout-projects-from-svn-completed.png		" style="width:250px; display:block;" />
	</li>
	
</ol>

<h3 id="how-to-configure-maven-eclipse-plugin-correctly">
	How To Configure the <code>maven-eclipse</code> Plugin "Correctly" For An Existing Project
</h3>
<p>Configure the maven-eclipse plugin so that no extra code is generated during the import. 
Open the pom that contains your <code>&lt;pluginManagement&gt;</code> section (your root pom or 
parent pom) and locate the <code>maven-eclipse-plugin</code>. The configuration should be like the 
listing below:
<pre>

  &lt;pluginManagement&gt;
    &lt;plugins&gt;
      .
      .
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-eclipse-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
        &lt;configuration&gt;
          &lt;downloadSources&gt;true&lt;/downloadSources&gt;
          &lt;downloadJavadocs&gt;true&lt;/downloadJavadocs&gt;
          &lt;addVersionToProjectName&gt;false&lt;/addVersionToProjectName&gt;
          &lt;projectNameTemplate&gt;[artifactId]&lt;/projectNameTemplate&gt;
          &lt;wtpmanifest&gt;false&lt;/wtpmanifest&gt;
          &lt;wtpapplicationxml&gt;false&lt;/wtpapplicationxml&gt;
          &lt;wtpversion&gt;2.0&lt;/wtpversion&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      .
      .
    &lt;/plugins&gt;
  &lt;/pluginManagement&gt;
</pre>
</p>

<h3>How To Download Sources and Javadocs for Maven Dependencies</h3>
<p>
The <code>m2eclipse</code> plugin seems to be a bit unpredictable when it comes to downloading 
sourcecode and javadocs for the projects dependencies. If you find that source code and javadocs are 
missing for some dependencies, then try this: 
</p>
<ul>
	<li>
		Navigate to the project folder, e.g. <code>${SEAM_TUTORIAL}</code>, using a command shell and 
		execute:
	</li>
	<li>
		<code style="white-space:nowrap">mvn eclipse:eclipse -DdownloadSources=true 
		-DdownloadJavadocs=true</code>
	</li>
</ul>

<h3 id="remove-eclipse-settings">How To Completly Remove Eclipse Spesific Settings From a Project</h3>
<p>If you find yourself in a situation where your Eclipse project has reached a limbo, then you are 
faced with two options: Delete the project from your local file system or try to clean up the mess 
caused by Eclipse (and you?).
</p>
<p>Steps required to clean up Eclipse mess:</p>
<ol>
	<li>
		Delete the project from Eclipse. 
		<img src="img/eclipse-delete-project.png" style="width:450px; display:block;" />
	</li>
	<li>
		Exit Eclipse, navigate to the projct folder, e.g. the <code>${SEAM_TUTORIAL}</code> folder using 
		a command shell and execute maven commands:
		<ul>
			<li><code>mvn clean -Punexplode</code></li>
			<li><code>mvn eclipse:clean</code></li>
		</ul>
	</li>
	<li>
		The <code>mvn eclipse:clean</code> goal delets most of the Eclipse spesific project files, but 
		not all of them. We need to clean up the remaining <strong>dot</strong> files ourselves: 
		Browse all project folders refered in the <code>&lt;modules&gt;</code> section of the parent pom
		and delete all <strong>dot</strong> files that belongs to Eclipse, e.g. 
		<ul>
			<li>.classpath</li>
			<li>.project</li>
			<li>.settings/</li>
			<li>appClientModule/</li>
			<li>.externalToolBuilders/</li>
			<li>*.launch</li> 
			<li>.metadata/</li>
		</ul>
	</li>
	<li>
		Execute maven commands:
		<ul>
			<li><code>mvn install -Pexplode</code></li>
			<li><code>mvn eclipse:m2eclipse</code></li>
		</ul>
		The last Maven command will generate the Eclipse <code>.project</code>, <code>.classpath</code> 
		and WTP files that now makes the project a valid Eclipse project. 
	</li>
	<li>
		<a href="#import-project-into-eclipse">Open Eclipse and import the project</a>.
	</li>
</ol>

<h3>
	How To Solve: Access restriction: The type Xyz is not accessible due to restriction on required 
	library rt.jar
</h3>
<p>See: 
	<a href="http://forums.dzone.com/eclipse/384-access-restriction-problems.html">
	access restriction problems 
	</a>
</p>

<h3>
	How To Solve: Build path contains duplicate entry: 'org.eclipse.jst.j2ee.internal.module.container' 
	for project
</h3>
<p>See: 
	<a href="http://www.nabble.com/Build-path-contains-duplicate-entry:-%27org.eclipse.jst.j2ee.internal.module.container%27-td23028022.html">
	Build path contains duplicate entry: 'org.eclipse.jst.j2ee.internal.module.container'
	</a>
</p>
<h3>
	How To Solve: The Maven 2.0.2 XML parser fails to parse a UTF-8 POM that begins with the optional 
	byte-order mark
</h3>
<p>
Do not add Maven projects under your workspace folder. There are some issues regarding use of the 
m2eclipse plugin when projects are placed under the workspace folder, e.g. 
<code style="white-space:nowrap">C:/dev/ide/workspaces/eclipse-3.4/myproject</code>: You will not be 
able to run Maven Eclipse goals from a command shell if your project is placed under the workspace 
folder; the <code>mvn eclipse:eclipse, mvn eclipse:clean and mvn eclipse:m2eclipse</code> goals will 
fail to execute. The issues are reported here: <a href="http://jira.codehaus.org/browse/MECLIPSE-571">
http://jira.codehaus.org/browse/MECLIPSE-571</a>, and here:	
<a href="http://jira.codehaus.org/browse/MNG-2057">http://jira.codehaus.org/browse/MNG-2057</a>.
So, be kind to yourself and create a project folder that is not on the same file path as the 
workspace folder, e.g. <code style="white-space:nowrap">C:/dev/projects</code>
</p>

<h3>How To Browse (ctrl+clik) Into Java Code From a Visual Editor</h3>
<p>The WAR pom must list all Java modules you want to browse into:
<pre>

  &lt;dependencies&gt;

    &lt;!-- project --&gt; 
    &lt;!-- 
      For Eclipse and JBoss Tools:
      List all modules you are interested to browse (ctrl+click) into from xhtml pages 
    --&gt;<font color="blue">
    &lt;dependency&gt;
      &lt;groupId&gt;${project.groupId}&lt;/groupId&gt;
      &lt;artifactId&gt;${app.context}-ejb&lt;/artifactId&gt;
      &lt;type&gt;ejb&lt;/type&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;</font>

    &lt;!-- seam --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.jboss.seam&lt;/groupId&gt;
      &lt;artifactId&gt;jboss-seam-ui&lt;/artifactId&gt;
    &lt;/dependency&gt;
    .
    .
  &lt;/dependencies&gt;
</pre>

</p>

<h3>How To Get JBoss Tools To Work In Vista 64 bit</h3>
<p>It only works partially! It seems that everything except for the visual editors (VPE) works fine. 
You will see the following message in the visual editor: <strong>"The VPE editor can't be run because 
your system environment needs to be changed slightly. 
<a href='http://www.jboss.org/community/wiki/JBosstoolsVisualEditorFAQ'>Find out more</a>"</strong>.
The link points to a page with no information regarding how to fix this for Vista64 with Jdk-6 64 bit 
and Eclipse-3.4 64 bit. You will also find that you are not able to browse into java code from the 
visual editor, which for me is the most essential feature of the VPE. The only workaround I have 
found so far is to download and install 32 bit versions of Jdk-6 and Eclipse-3.4 and install the 
required plugins in the Eclipse-3.4 32 bit environment. The visual editors works as expected with 
the 32 bit configuration.</p>
<p>After installation of Jdk-6 32 bit and Eclipse-3.4 32 bit, ensure that Eclipse uses the "correct" 
jdk. Open the <code>eclipse.ini</code> file and add path to the 32 bit Jdk version as emphasized in 
text below:
<pre>
<strong><font color="blue">-vm
C:/Program Files (x86)/Java/jdk1.6.0_16/bin</font></strong>
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
512M
-framework
plugins\org.eclipse.osgi_3.4.3.R34x_v20081215-1030.jar
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms128m
-Xmx512m
</pre>
</p>

<h2>Useful Links</h2>
<ul>
	<li>
		<a href="http://www.next-presso.fr/2009/06/wtp-m2eclipse-seam-cest-bien-maven/lang/en/">
			WTP + M2eclipse + Seam : Maven works !
		</a>
	</li>
	<li>
		<a href="http://blog.xebia.com/2009/06/06/configuring-a-seam-ejb-project-for-development-with-maven-and-jboss-tools/">
			Configuring a Seam EJB project for development with Maven and JBoss Tools
		</a>
	</li>
	<li>
		<a href="http://kasper.eobjects.dk/2009/04/seam-ejbs-and-ear-packaging-in-maven.html">
			Seam, EJB's and EAR-packaging in Maven
		</a>
	</li>
	<li>
		<a href="http://www.innovationontherun.com/common-issues-and-workarounds-while-building-ear-files-in-eclipse/">
			Common Issues and Workarounds While Building EAR files in Eclipse
		</a>
	</li>
	<li>
		<a href="http://docs.codehaus.org/display/M2ECLIPSE/Integration+with+WTP">
			Integration with WTP
		</a>
	</li>
	<li>
		<a href="http://www.theserverside.com/tt/articles/article.tss?l=Introductiontom2eclipse">
			Introduction to m2eclipse
		</a>
	</li>
</ul>

<p>&nbsp;</p>
</div> <!-- #page -->
</div> <!-- #page-wrapper -->
<div id="footer">  
  <div class="footer">
  <ul class="links" style="text-align: center;">
    <li><a href="01-gettingstarted.html"><strong>Getting started</strong> tutorial</a></li>
    <li><a href="02-eclipse.html"><strong>Eclipse</strong> tutorial</a></li>
    <li><a href="03-intellij.html"><strong>IntelliJ</strong> tutorial</a></li>
    <li><a href="04-netbeans.html"><strong>NetBeans</strong> tutorial</a></li>
  </ul>
  </div>
</div> <!-- #footer -->
</div> <!-- #expander -->
</div> <!-- #sizer -->
<!--
	<script type="text/javascript">
		var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
		document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
				var pageTracker = _gat._getTracker("UA-9570909-1");
				pageTracker._trackPageview();
		} catch(err) {
		}</script>
-->
</body>
</html>
